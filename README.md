# Huawei eNB RRC and S1AP csv logs to pcap files

This simpple application transform CSV logs generated by Huawei eNB OSS into pcap files 
The logs files can have RRC or S1AP protocol.

Example of S1AP log:

```
"Result: 20190221_S1 Interface Trace"
"Save Time: 02/22/2019 12:01:33"
"User Name:xxxxxxx"
""

"Total 211 Records"

"No.","Time","Standard Interface Message Type","Message Direction","S1 Interface ID","Call ID","PLMN","Local Cell ID","CPU ID","Message Content"
52487,02/21/2019 15:34:09 (838),S1AP_INITIAL_UE_MSG,To MME,44301,198873952,12345,71,1798,00 0C 40 6F 00 00 06 00 08 00 04 80 22 ...
52537,02/21/2019 15:34:09 (929),S1AP_DL_NAS_TRANS,From MME,44301,198873952,12345,71,1798,00 0B C0 3D 00 00 03 00 00 00 05 C0 0E ...
53284,02/21/2019 15:34:11 (294),S1AP_UL_NAS_TRANS,To MME,44301,198873952,12345,71,1798,00 0D 40 3A 00 00 05 00 00 00 05 C0 0E A0 ...
53304,02/21/2019 15:34:11 (340),S1AP_DL_NAS_TRANS,From MME,44301,198873952,12345,71,1798,00 0B C0 27 00 00 03 00 00 00 05 C0 0E ...
53375,02/21/2019 15:34:11 (475),S1AP_UL_NAS_TRANS,To MME,44301,198873952,12345,71,1798,00 0D 40 42 00 00 05 00 00 00 05 C0 0E A0 ...
53404,02/21/2019 15:34:11 (553),S1AP_DL_NAS_TRANS,From MME,44301,198873952,12345,71,1798,00 0B C0 22 00 00 03 00 00 00 05 C0 0E ...
53627,02/21/2019 15:34:11 (950),S1AP_UL_NAS_TRANS,To MME,44301,198873952,12345,71,1798,00 0D 40 53 00 00 05 00 00 00 05 C0 0E A0 ...
53786,02/21/2019 15:34:12 (205),S1AP_INITIAL_CONTEXT_SETUP_REQ,From MME,44301,198873952,12345,71,1798,00 09 C0 80 CF 00 00 06 00 ...
54835,02/21/2019 15:34:13 (978),S1AP_UE_CAPABILITY_INFO_IND,To MME,44301,198873952,12345,71,1798,00 16 C0 27 00 00 04 00 00 00 05 ...
75532,02/21/2019 15:34:48 (985),S1AP_INITIAL_CONTEXT_SETUP_FAIL,To MME,44301,198873952,12345,71,1798,40 09 00 1A 00 00 03 00 00 40 ...
75558,02/21/2019 15:34:49 (39),S1AP_UE_CONTEXT_REL_CMD,From MME,44301,N/A,N/A,N/A,1798,00 17 00 16 00 00 02 00 63 00 09 0C 0E A0 ...
75559,02/21/2019 15:34:49 (39),S1AP_UE_CONTEXT_REL_CMP,To MME,44301,N/A,N/A,N/A,1798,20 17 00 14 00 00 02 00 00 40 05 C0 0E A0 02 ...
```

Example of RRC log:

```
"Result: 20190221_Uu Interface Trace"
"Save Time: 02/22/2019 11:52:59"
"User Name:xxxxxxx"
""

"Total 185 Records"

"No.","Time","Standard Interface Message Type","Message Direction","Local Cell ID","CPU ID","Call ID","PLMN","CRNTI","Message Content"
1,02/21/2019 15:34:08 (693),RRC_CONN_REQ_NB,From UE,71,1798,198873952,N/A,N/A,21 28 17 88 00 F1 D4 40 00 00
2,02/21/2019 15:34:08 (698),RRC_CONN_SETUP_NB,To UE,71,1798,198873952,N/A,31411,20 34 13 31 F8 C0 61 A6 69 E4 3E 74 27 58
3,02/21/2019 15:34:09 (838),RRC_CONN_SETUP_CMP_NB,From UE,71,1798,198873952,N/A,31411,1F 12 80 05 E2 00 3C 75 1D 03 A0 B8 ... 
4,02/21/2019 15:34:09 (930),RRC_DL_INFO_TRANSF_NB,To UE,71,1798,198873952,12345,31411,1E 04 09 01 D4 81 9E EF 01 78 07 54 ... 
5,02/21/2019 15:34:11 (294),RRC_UL_INFO_TRANSF_NB,From UE,71,1798,198873952,12345,31411,1F 30 0B 07 53 08 E5 65 74 8F 06 ...
6,02/21/2019 15:34:11 (341),RRC_DL_INFO_TRANSF_NB,To UE,71,1798,198873952,12345,31411,1E 04 03 8D F2 E2 88 40 80 01 D7 ...
7,02/21/2019 15:34:11 (475),RRC_UL_INFO_TRANSF_NB,From UE,71,1798,198873952,12345,31411,1F 30 13 47 45 2E D7 EA 00 C4 ...
8,02/21/2019 15:34:11 (554),RRC_DL_INFO_TRANSF_NB,To UE,71,1798,198873952,12345,31411,1E 04 02 49 D2 A7 AF A0 00 7A 68 ...
9,02/21/2019 15:34:11 (949),RRC_UL_INFO_TRANSF_NB,From UE,71,1798,198873952,12345,31411,1F 30 24 27 46 1A E7 11 01 2F ...
10,02/21/2019 15:34:12 (206),RRC_UE_CAP_ENQUIRY_NB,To UE,71,1798,198873952,12345,31411,1E 44 00
```



Usage: python3 huawei2pcap.py <file_csv_to_read> <file_pcap_to_save>
